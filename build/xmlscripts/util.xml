<?xml version="1.0" encoding="UTF-8"?>
<!--
/**
 * util.xml
 *
 * @copyright Copyright (c) 2016 Staempfli AG
 * @author    juan.alonso@staempfli.com
 */
-->
<project name="Util" default="..." basedir=".">

    <target name="util:properties"
            hidden="true">

        <!-- get the project name automatically as the project root directory -->
        <exec command="basename ${application.startdir}" outputProperty="project.name"/>

        <property file="${application.startdir}/../_conf/environment.properties"/>
        <property file="${application.startdir}/config/mg2-builder/project.properties"/>
        <property file="${phing.dir}/build/config/default.properties"/>

        <customHook hook="after-read-properties"/>
    </target>

    <target name="util:environment"
            hidden="true">

        <if>
            <isset property="project.environment"/>
            <then>
                <echo message="Environment already set to ${project.environment}"/>
            </then>
            <else>
                <input propertyName="project.environment" validArgs="local,igr"
                       message="Please specify the Project environment: "/>
            </else>
        </if>
    </target>

    <target name="util:db:clean"
            depends="util:properties,
            database:properties,
            tests-setup:properties,
            magento:cache:clean,
            database:drop,
            tests-setup:integration:db:drop"
            hidden="true">

        <customHook hook="after-util-db-clean"/>

        <echo message="Clean up databases done"/>
    </target>

</project>